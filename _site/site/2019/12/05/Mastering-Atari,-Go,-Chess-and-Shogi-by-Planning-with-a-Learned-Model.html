<h2 id="introduction">Introduction</h2>

<ul>
  <li>
    <p>The paper presents the MuZero algorithm that performs planning with a learned model.</p>
  </li>
  <li>
    <p>The algorithm achieves state of the art results on Atari suite (where generally model-free approaches perform the best) and on planning-oriented games like Chess and Go (where generall planning approaches perform the best).</p>
  </li>
  <li>
    <p><a href="https://arxiv.org/abs/1911.08265">Link to the paper</a></p>
  </li>
</ul>

<h2 id="relation-to-standard-model-based-approaches">Relation to standard Model-Based Approaches</h2>

<ul>
  <li>
    <p>Model-based approaches generally focus on reconstructing the true environment state or the sequence of full observations.</p>
  </li>
  <li>
    <p>MuZero focuses on predicting only those aspects that are most relevant for planning - policy, value functions, and rewards.</p>
  </li>
</ul>

<h2 id="approach">Approach</h2>

<ul>
  <li>
    <p>The model consists of three components: (representation) encoder, dynamics function, and the prediction network.</p>
  </li>
  <li>
    <p>The learning agent has two kinds of interactions - real interactions (ie the actions that are actually executed in the real environment) and hypothetical or imaginary actions (ie the actions that are executed in the learned model or the dynamics function).</p>
  </li>
  <li>
    <p>At any timestep <em>t</em>, the past observations <em>o<sub>1</sub></em>, … <em>o<sub>t</sub></em> are encoded into the state <em>s<sub>t</sub></em> using the encoder.</p>
  </li>
  <li>
    <p>Now the model takes hypothetical actions for the next <em>K</em> timesteps by unrolling the model for <em>K</em> steps.</p>
  </li>
  <li>
    <p>For each timestep <em>k = 1, …, K</em>, the dynamics model predicts the immediate reward <em>r<sub>k</sub></em> and a new hidden state <em>h<sub>k</sub></em> using the previous hidden state <em>h<sub>k-1</sub></em> and action <em>a<sub>k</sub></em>.</p>
  </li>
  <li>
    <p>At the same time, the policy <em>p<sup>k</sup></em> and the value function <em>v<sup>k</sup></em> are computed using the prediction network.</p>
  </li>
  <li>
    <p>The initial hidden state <em>h<sub>0</sub></em> is initialized using the state <em>s<sub>t</sub></em></p>
  </li>
  <li>
    <p>Any MDP Planning algorithm can be used to search for optimal policy and value function given the state transitions and the rewards induced by the dynamics function.</p>
  </li>
  <li>
    <p>Specifically, the MCTS (Monte Carlo Tree Search) algorithm is used and the action <em>a<sub>t+1</sub></em> (ie the action that is executed in the actual environment) is selected from the policy outputted by MCTS.</p>
  </li>
</ul>

<h2 id="collecting-data-for-the-replay-buffer">Collecting Data for the Replay Buffer</h2>

<ul>
  <li>
    <p>At each timestep <em>t</em>, the MCTS algorithm is executed to choose the next action (which will be executed in the real environment).</p>
  </li>
  <li>
    <p>The resulting next observation <em>o<sub>t+1</sub></em> and reward <em>r<sub>t+1</sub></em> are stored and the trajectory is written to the replay buffer (at the end of the episode).</p>
  </li>
</ul>

<h2 id="objective">Objective</h2>

<ul>
  <li>
    <p>For every hypothetical step <em>k</em>, match the predicted policy, value, and reward to the actual target values.</p>
  </li>
  <li>
    <p>The target policy is generated by the MCTS algorithm.</p>
  </li>
  <li>
    <p>The target value function and reward are generated by actually playing the game (or the MDP).</p>
  </li>
</ul>

<h2 id="relation-to-alphazero">Relation to AlphaZero</h2>

<ul>
  <li>
    <p>MuZero leverages the search-based policy iteration from AlphaZero.</p>
  </li>
  <li>
    <p>It extends AlphaZero to setups with a single agent (where self-play is not possible) and setups with a non-zero reward at the intermediate time steps.</p>
  </li>
  <li>
    <p>The encoder and the predictions functions are similar to ones used by AlphZero.</p>
  </li>
</ul>

<h2 id="results">Results</h2>

<ul>
  <li>
    <p><em>K</em> is set to 5.</p>
  </li>
  <li>
    <p>Environments: 57 games in Atari along with Chess, Go and Shogi</p>
  </li>
  <li>
    <p>MuZero achieves the same level of performance as AlphaZero for Chess and Shogi. In Go, MuZero slightly outperforms AlphaZero despite doing fewer computations per node in the search tree.</p>
  </li>
  <li>
    <p>In Atari, MuZero achieves a new state-of-the-art compared to both model-based and model-free approaches.</p>
  </li>
  <li>
    <p>The paper considers a variant called MuZero Reanalyze that reanalyzes old trajectories by re-running the MCTS algorithm with the updated network parameter. The motivation is to have a better sample complexity.</p>
  </li>
  <li>
    <p>MuZero performs well even when using a single simulation of MCTS (during inference).</p>
  </li>
  <li>
    <p>During training, using more simulations of MCTS helps to achieve better performance through even just 6 simulations per move is sufficient to learn a good model for Ms. Pacman.</p>
  </li>
</ul>
